(this["webpackJsonpdtp-map"]=this["webpackJsonpdtp-map"]||[]).push([[0],{46:function(e,t,a){e.exports=a(58)},51:function(e,t,a){},56:function(e,t,a){},58:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(38),o=a.n(c),i=a(65),l=(a(51),"https://dtp-stat.ru/api"),s="https://dtp-stat.ru",u="https://2ab4410dbc6440a7ab3bfd0963c217d5@o412018.ingest.sentry.io/5288112",d=a(6),m=a(12),f=a.n(m),p=a(1),v=a(39),g=a.n(v);var b,y,h=function(e,t){var a;return null===(a=b)||void 0===a||a.abort(),b=new AbortController,fetch("".concat(l,"/stat/?center_point=").concat(e[1],"+").concat(e[0],"&scale=").concat(t),{signal:b.signal}).then((function(e){return e.json()}))},E={},w=function(e,t){var a;return null===(a=y)||void 0===a||a.abort(),y=new AbortController,Promise.all(e.map((function(e){return function(e,t,a){var n,r=null===(n=E[a])||void 0===n?void 0:n[t];return r?Promise.resolve(r):fetch("".concat(l,"/dtp_load/?year=").concat(t,"&region_slug=").concat(a,"&format=json"),{signal:e}).then((function(e){return e.json()})).then((function(e){return E[a]||(E[a]={}),E[a][t]=e,e}))}(y.signal,e,t)})))},N=p.types.model("DateValue",{start_date:p.types.string,end_date:p.types.string}),S=p.types.model("DateFilter",{name:p.types.literal("date"),label:p.types.string,default_value:N,value:p.types.optional(N,{start_date:"",end_date:""})}).actions((function(e){return{afterCreate:function(){e.value=e.default_value},setValue:function(t){e.value=Object(p.cast)(t),Object(p.getRoot)(e).onDatesChanged()}}})),j=p.types.model("ParticipantItem",{preview:p.types.string,value:p.types.number,icon:p.types.string,default:p.types.boolean,selected:!1}).actions((function(e){return{afterCreate:function(){e.selected=e.default},setSelected:function(t){e.selected=t},selectOne:function(){e.selected||(Object(p.getParent)(e).forEach((function(t){t.setSelected(t===e)})),Object(p.getRoot)(e).onFiltersChanged())}}})),k=p.types.model("ParticipantsFilter",{name:p.types.literal("participant_categories"),label:p.types.string,multiple:p.types.boolean,values:p.types.array(j)}),C=p.types.model("SeverityItem",{preview:p.types.string,value:p.types.number,color:p.types.string,disabled:p.types.boolean,default:p.types.boolean,selected:!1}).actions((function(e){return{afterCreate:function(){e.selected=e.default},changeSelection:function(){e.selected=!e.selected,Object(p.getRoot)(e).onFiltersChanged()}}})),O=p.types.model("SeverityFilter",{name:p.types.literal("severity"),label:p.types.string,multiple:p.types.boolean,values:p.types.array(C)}),F=p.types.model("RegionFilter",{name:p.types.literal("region"),label:p.types.string,values:p.types.array(p.types.number)}),_=p.types.model("CategoryFilterValue",{preview:p.types.string,value:p.types.number,default:!1,selected:!1}).actions((function(e){return{toggle:function(){e.selected=!e.selected,Object(p.getRoot)(e).onFiltersChanged()},reset:function(){e.selected=e.default}}})),x=p.types.model("CategoryFilter",{name:p.types.literal("category"),key:p.types.string,label:p.types.string,values:p.types.array(_)}).actions((function(e){return{reset:function(){e.values.forEach((function(e){return e.reset()})),Object(p.getRoot)(e).onFiltersChanged()},navigate:function(){Object(p.getRoot)(e).filterStore.setCurrentKey(e.key)}}}));p.types.union(k,S,O,F,x);function A(e){switch(e.name){case"date":return S.create(e);case"participant_categories":return k.create(e);case"severity":return O.create(e);case"region":return F.create(e);case"category":return x.create(e)}}var L=p.types.model("FilterStore",{filters:p.types.array(p.types.union(k,S,O,F,x)),visible:!0,search:"",currentKey:p.types.maybeNull(p.types.string)}).actions((function(e){function t(t){e.filters.clear(),e.filters=Object(p.cast)(t.map(A))||[]}var a=Object(p.flow)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(l,"/filters")).then((function(e){return e.json()}));case 2:t(e.sent);case 4:case"end":return e.stop()}}),e)})));return{setFilters:t,updateStreets:function(t){if(t){var a=e.filters.find((function(e){return"street"===e.key}));if(a){var n=new Set(t.filter((function(e){return e.street})).map((function(e){return e.street}))),r=new Set(a.values.filter((function(e){return e.selected})).map((function(e){return e.preview})));r.forEach((function(e){n.add(e)}));var c=Array.from(n);c.sort();var o=c.map((function(e){return _.create({preview:e,value:-1,selected:r.has(e)})}));a.values=Object(p.cast)(o)}}},loadFilters:a,setCurrentKey:function(t){e.currentKey=t},setVisible:function(t){e.visible=t},setSearch:function(t){e.search=t}}})).views((function(e){return{get date(){var t=e.filters.filter((function(e){return"date"===e.name}));return null===t||void 0===t?void 0:t[0]},get startDate(){var e;return null===(e=this.date)||void 0===e?void 0:e.value.start_date},get endDate(){var e;return null===(e=this.date)||void 0===e?void 0:e.value.end_date}}})),D=a(43),I=a(36),R=a(37),P=a.n(R),z="#18334A",H="#8d99a5",M="#FF001A",B="#FFB81F",K=function(e){var t=e.datetime.toLocaleString("ru",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"}),a="".concat(e.injured," \u0447\u0435\u043b\u043e\u0432\u0435\u043a \u043f\u043e\u0441\u0442\u0440\u0430\u0434\u0430\u043b\u0438");e.injured%10===1&&11!==e.injured&&(a="".concat(e.injured," \u0447\u0435\u043b\u043e\u0432\u0435\u043a \u043f\u043e\u0441\u0442\u0440\u0430\u0434\u0430\u043b"));var n="".concat(e.dead," \u0447\u0435\u043b\u043e\u0432\u0435\u043a \u043f\u043e\u0433\u0438\u0431\u043b\u0438");return e.dead%10===1&&11!==e.dead&&(n="".concat(e.dead," \u0447\u0435\u043b\u043e\u0432\u0435\u043a \u043f\u043e\u0433\u0438\u0431")),r.a.createElement("div",{className:"balloon-content"},r.a.createElement("h4",{className:"subtitle1"},e.categoryName),r.a.createElement("p",{className:"balloon-time body3"},t),e.address&&r.a.createElement("p",{className:"balloon-address body3"},e.address),r.a.createElement("div",{className:"balloon-injured"},e.injured>0&&r.a.createElement("p",{className:"subtitle3",style:{color:B}},a),e.dead>0&&r.a.createElement("p",{className:"subtitle3",style:{color:M}},n)),r.a.createElement("div",{className:"balloon-footer"},r.a.createElement("a",{id:"balloon-button",className:"btn-light",href:"".concat(s,"/dtp/").concat(e.id),target:"_blank",rel:"noopener noreferrer"},"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u043e\u0441\u0442\u0438 \u0414\u0422\u041f")))},U={0:"svg/circle-0.svg",1:"svg/circle-1.svg",3:"svg/circle-3.svg",4:"svg/circle-4.svg",default:"svg/circle-default.svg"},T={1:"#FFB81F",3:"#FF7F24",4:"#FF001A"},V=p.types.model("MapStore",{center:p.types.array(p.types.number),zoom:1}).actions((function(e){var t=null,a=null,n=null;function r(t,a){var n=e.zoom;e.center=Object(p.cast)(t),e.zoom=a,Object(p.getRoot)(e).onBoundsChanged(a,n)}var c=function(e){var t=a.objects.getById(e);t&&(t.properties.balloonContentBody=P.a.renderToStaticMarkup(K({id:t.properties.id,address:t.properties.address,categoryName:t.properties.category_name,dead:t.properties.dead,datetime:new Date(t.properties.datetime),injured:t.properties.injured})),a.objects.balloon.open(e))},o=function(e){e.properties.balloonContentBody=P.a.renderToStaticMarkup(K({id:e.properties.id,address:e.properties.address,categoryName:e.properties.category_name,dead:e.properties.dead,datetime:new Date(e.properties.datetime),injured:e.properties.injured})),i(e.id)},i=function(e){var t=new URLSearchParams(document.location.search);t.set("active-obj",e),window.history.pushState(null,"","?".concat(t.toString()))},l=function(){var e=new URLSearchParams(document.location.search);e.delete("active-obj"),window.history.pushState(null,"","?".concat(e.toString()))};return{setMap:function(e){t=e,(a=new window.ymaps.ObjectManager({clusterize:!0,groupByCoordinates:!0,showInAlphabeticalOrder:!0,clusterDisableClickZoom:!0,clusterIconLayout:"default#pieChart"})).objects.events.add("click",(function(e){c(e.get("objectId"))})),a.objects.balloon.events.add("userclose",(function(){l()})),a.objects.balloon.events.add("open",(function(e){i(e.get("objectId"))})),a.clusters.balloon.events.add("close",(function(){l()})),a.clusters.state.events.add("change",(function(){o(a.clusters.state.get("activeObject"))})),a.clusters.balloon.events.add("close",(function(){l()})),(n=new window.ymaps.Heatmap([],{radius:15,dissipating:!1,opacity:.5,intensityOfMidpoint:.5,gradient:{0:"rgba(126, 171, 85, 0.0)",.2:"rgba(126, 171, 85, 0.6)",.4:"rgba(255, 254, 85, 0.7)",.6:"rgba(245, 193, 66, 0.8)",.8:"rgba(223, 130, 68, 0.9)",1:"rgba(176, 36, 24, 1)"}})).setMap(t,{}),t.geoObjects.add(a),r(t.getCenter(),t.getZoom())},getMap:function(){return t},updateBounds:r,drawPoints:function(e){a.removeAll(),n.setData([]);var t=e.map((function(e){return{type:"Feature",id:(t=e).id,geometry:{type:"Point",coordinates:[t.point.latitude,t.point.longitude]},properties:Object(D.a)({},t,{clusterCaption:t.datetime.split("T")[0],visible:!0}),options:{iconLayout:"default#image",iconImageHref:U[t.severity],iconImageSize:[10,10],iconImageOffset:[-5,-5],iconColor:T[t.severity]}};var t}));a.add(t);var r=new URLSearchParams(window.location.search).get("active-obj");r&&c(r)},drawHeat:function(e){a.removeAll();var t=e.map((function(e){return{id:(t=e).id,type:"Feature",geometry:{type:"Point",coordinates:[t.point.latitude,t.point.longitude]},properties:{weight:t.severity}};var t}));n.setData(t)},setFilter:function(e){a.setFilter((function(t){return e(t.properties)}))}}})),Z=p.types.model("Area",{id:p.types.string,name:p.types.string,parentId:p.types.string,parentName:p.types.maybeNull(p.types.string)}),W=p.types.model("AreaStatistics",{count:p.types.number,injured:p.types.number,dead:p.types.number}),J=p.types.model("AreaStore",{area:p.types.maybeNull(Z),statistics:p.types.maybeNull(W)}).actions((function(e){return{loadArea:Object(p.flow)(f.a.mark((function t(a,n){var r,c,o,i,l,s;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h(a,n);case 3:if(o=t.sent,u=o,0!==Object.keys(u).length){t.next=6;break}return t.abrupt("return");case 6:i=Z.create({id:o.region_slug,name:o.region_name,parentId:o.parent_region_slug,parentName:o.parent_region_name}),l=i.id!==(null===(r=e.area)||void 0===r?void 0:r.id),s=i.parentId!==(null===(c=e.area)||void 0===c?void 0:c.parentId),e.area=i,l&&Object(p.getRoot)(e).onAreaChanged(),s&&Object(p.getRoot)(e).onParentAreaChanged(),t.next=18;break;case 14:if(t.prev=14,t.t0=t.catch(0),"AbortError"===t.t0.name){t.next=18;break}throw t.t0;case 18:case"end":return t.stop()}var u}),t,null,[[0,14]])}))),setStatistics:function(t){e.statistics=Object(p.cast)(t)}}})),Y=function(e,t){for(var a=[],n=parseInt(e.split("-")[0]),r=parseInt(t.split("-")[0]),c=n;c<=r;c++)a.push(c);return a},$=p.types.model({accs:p.types.frozen([])}).actions((function(e){return{loadTrafficAccidents:Object(p.flow)(f.a.mark((function t(a,n,r){var c,o;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(c=Object(p.getRoot)(e)).incLoading(),t.prev=2,t.next=5,w(Y(a,n),r);case 5:o=t.sent,e.accs=o.flat().filter((function(e){return e.datetime>=a&&e.datetime<=n+"Z"})),c.onTrafficAccidentsLoaded(),t.next=14;break;case 10:if(t.prev=10,t.t0=t.catch(2),"AbortError"===t.t0.name){t.next=14;break}throw t.t0;case 14:return t.prev=14,c.decLoading(),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[2,10,14,17]])})))}})),q=p.types.model("RootStore",{filterStore:L,mapStore:V,areaStore:J,trafficAccidentStore:$,loadingCount:0}).actions((function(e){var t=!1,a=!1,n=Object(p.flow)(f.a.mark((function n(){return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return v(),n.next=3,e.filterStore.loadFilters();case 3:g(),b(),a=!0,t&&(s(),r());case 7:case"end":return n.stop()}}),n)}))),r=function(){var t=e.mapStore,a=t.center,n=t.zoom;e.areaStore.loadArea(a,n)},c=function(){var t=e.areaStore,a=e.filterStore,n=e.trafficAccidentStore;t.area&&n.loadTrafficAccidents(a.startDate,a.endDate,t.area.parentId)},o=function(){var t=e.trafficAccidentStore.accs,a=e.areaStore.area;if(a){var n=(a.id===a.parentId?t:t.filter((function(e){return e.region_slug===a.id}))).filter(i());e.areaStore.setStatistics({count:n.length,injured:n.reduce((function(e,t){return e+t.injured}),0),dead:n.reduce((function(e,t){return e+t.dead}),0)})}},i=function(){var t=function(e){var t,a=[],n=Object(I.a)(e.filter((function(e){return"date"!==e.name})));try{for(n.s();!(t=n.n()).done;){var r=t.value,c=r.values.filter((function(e){return e.selected})).map((function(e){return-1===e.value?e.preview:e.value}));a.push({id:r.key||r.name,values:c})}}catch(o){n.e(o)}finally{n.f()}return a}(e.filterStore.filters.slice());return function(e){return function(e,t){var a,n=Object(I.a)(t);try{var r=function(){var t=a.value,n=e[t.id],r=t.values;if(0===r.length)return"continue";if(Array.isArray(n)){if(!n.some((function(e){return r.includes(e)})))return{v:!1}}else if(!r.includes(n))return{v:!1}};for(n.s();!(a=n.n()).done;){var c=r();switch(c){case"continue":continue;default:if("object"===typeof c)return c.v}}}catch(o){n.e(o)}finally{n.f()}return!0}(e,t)}},l=function(){var t=e.trafficAccidentStore.accs.filter((function(e){return e.point}));if(e.mapStore.zoom>=12)e.mapStore.setFilter(i()),e.mapStore.drawPoints(t);else{var a=t.filter(i());e.mapStore.drawHeat(a)}},s=function(){var e=new URLSearchParams(document.location.search);u(e),d(e),m(e),window.history.pushState(null,"","?".concat(e.toString()))},u=function(t){var a=e.mapStore,n=a.center,r=a.zoom;t.set("center","".concat(n[0],":").concat(n[1])),t.set("zoom",String(r))},d=function(t){var a=e.filterStore.filters.find((function(e){return"date"===e.name})).value;t.set("start_date",a.start_date),t.set("end_date",a.end_date)},m=function(t){e.filterStore.filters.filter((function(e){return"date"!==e.name})).forEach((function(e){var a=e.key||e.name;t.delete(a);var n=e.values.filter((function(e){return e.selected}));n.length>0&&t.set(a,n.map((function(e){return"street"===a?e.preview:String(e.value)})).join(";"))}))},v=function(){var t,a=new URLSearchParams(document.location.search),n=null===(t=a.get("center"))||void 0===t?void 0:t.split(":"),r=n?[parseFloat(n[0]),parseFloat(n[1])]:[55.76,37.64],c=a.get("zoom"),o=c?parseInt(c,10):12;e.mapStore.center=Object(p.cast)(r),e.mapStore.zoom=o},g=function(){var t=new URLSearchParams(document.location.search),a=e.filterStore.filters.find((function(e){return"date"===e.name})),n=t.get("start_date"),r=t.get("end_date");n&&r&&(a.value={start_date:n,end_date:r})},b=function(){var t=new URLSearchParams(document.location.search);e.filterStore.filters.filter((function(e){return"date"!==e.name})).forEach((function(e){var a=e.key||e.name,n=t.get(a);if(n){var r=n.split(";");e.values.forEach((function(e){var t="street"===a?e.preview:String(e.value);e.selected=r.includes(t)}))}}))},y=function(){var t=new URLSearchParams(document.location.search),a=e.filterStore.filters.find((function(e){return"street"===e.key})),n=t.get("street");if(n){var r=n.split(";");a.values.forEach((function(e){e.selected=r.includes(e.preview)}))}};return{afterCreate:n,onBoundsChanged:function(e,n){t=!0,a&&(s(),r(),(e>=12&&n<12||e<12&&n>=12)&&l())},onAreaChanged:function(){o()},onParentAreaChanged:function(){c()},onTrafficAccidentsLoaded:function(){var t=e.trafficAccidentStore.accs;e.filterStore.updateStreets(t),y(),o(),l()},onDatesChanged:function(){s(),c()},onFiltersChanged:function(){s(),o(),e.mapStore.zoom>=12?e.mapStore.setFilter(i()):l()},incLoading:function(){e.loadingCount+=1},decLoading:function(){e.loadingCount-=1}}})).create({filterStore:{},mapStore:{},areaStore:{},trafficAccidentStore:{}});g()(q);var G=r.a.createContext(q);function Q(){return r.a.useContext(G)}var X=Object(d.a)((function(){var e=Q();return r.a.createElement("div",{className:e.loadingCount>0?"loader visible":"loader"})})),ee=(a(56),Object(d.a)((function(){var e=Q().mapStore,t=Object(n.useCallback)((function(t){var a=t.originalEvent,n=a.newCenter,r=a.newZoom,c=a.newBounds;e.updateBounds(n,r,c)}),[e]);r.a.useEffect((function(){window.ymaps.ready(["Heatmap"]).then((function(){var n=e.center,r=e.zoom,c=new window.ymaps.Map("map",{center:n,zoom:r,controls:[]},{avoidFractionalZoom:!0});e.setMap(c),c.events.add("boundschange",t),c.controls.add("zoomControl",{float:"none",size:"large"}).add("geolocationControl",{float:"none"});var o=function(e){var t=(e-250)/2;c.controls.get("zoomControl").options.set("position",{top:t,right:20}),c.controls.get("geolocationControl").options.set("position",{top:t+206+16,right:20})};o(a.current.offsetHeight),c.events.add("sizechange",(function(e){o(a.current.offsetHeight)}))}))}),[e,t]);var a=r.a.useRef();return r.a.createElement("div",{id:"map",ref:a})}))),te=a(34),ae=a(62),ne=a(66),re=a(67),ce=a(68),oe=a(63),ie=a(64),le=a(42),se=function(e){var t=e.handleClick,a=e.setShow,n=r.a.useRef();return ge(n,(function(){a(!1)})),r.a.createElement("div",{className:"date-menu",ref:n},ve.map((function(e){return r.a.createElement("div",{key:e.label,className:"date-value",onClick:function(a){return t(e)}},e.label)})))},ue=function(e){var t=e.split("-");if(2===t.length){var a=de(t[0].trim()),n=de(t[1].trim());if(a&&n)return{start:a,end:n}}return null},de=function(e){try{var t=Object(ne.a)(e,"d.M.y",new Date);return isNaN(t)?null:t}catch(a){return null}},me=function(e){return Object(re.a)(e,"yyyy-MM-dd")},fe=function(e){var t="dd.MM.yyyy";return"".concat(Object(re.a)(e.start,t)," - ").concat(Object(re.a)(e.end,t))},pe=function(e){var t=Object(ce.a)(new Date,e),a=Object(re.a)(t,"LLLL",{locale:le.a});return{label:a[0].toLocaleUpperCase("ru")+a.substring(1),start:Object(oe.a)(t),end:Object(ie.a)(t)}},ve=function(){for(var e=[],t=(new Date).getFullYear(),a=1;a<=2;a++)e.push(pe(a));for(var n=t;n>t-6;n--)e.push({label:n.toString(),start:new Date(n,0,1),end:new Date(n,11,31)});return e.push({label:"\u0417\u0430 \u0432\u0441\u0451 \u0432\u0440\u0435\u043c\u044f",start:new Date(2015,0,1),end:new Date}),e}(),ge=function(e,t){var a=function(a){e.current&&!e.current.contains(a.target)&&t()};r.a.useEffect((function(){return document.addEventListener("click",a),function(){document.removeEventListener("click",a)}}))},be=Object(d.a)((function(e){var t=e.filter,a={start:Object(ae.a)(t.value.start_date),end:Object(ae.a)(t.value.end_date)},n=r.a.useState(null),c=Object(te.a)(n,2),o=c[0],i=c[1],l=r.a.useState(!1),s=Object(te.a)(l,2),u=s[0],d=s[1],m=r.a.useState(null),f=Object(te.a)(m,2),p=f[0],v=f[1],g=r.a.useRef(!1),b=r.a.useRef(),y=function(e){i(null),v(null),t.setValue({start_date:me(e.start),end_date:me(e.end)}),g.current=!1,b.current.blur()};return r.a.createElement("div",null,r.a.createElement("div",{className:"date-main"},r.a.createElement("div",{className:"inputWrap"},r.a.createElement("input",{ref:b,type:"text",className:"input date-input",value:o||fe(a),spellCheck:"false",onChange:function(e){p&&v(null),i(e.target.value),g.current=!0},onKeyDown:function(e){if("Enter"===e.key){var t=ue(e.target.value);if(t){var a=(new Date).getFullYear(),n=new Date(a,11,31);t.end>=t.start&&t.start>=new Date(2015,0,1)&&t.end<=n?y(t):v("\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043f\u0435\u0440\u0438\u043e\u0434.\n\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435: 2015-".concat(a))}else v("\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442.\n\u041f\u0440\u0438\u043c\u0435\u0440: 1.1.2020 - 31.12.2020")}},onBlur:function(e){g.current&&(i(null),v(null),g.current=!1)}})),r.a.createElement("div",{className:"date-dropdown"},r.a.createElement("button",{className:"date-button",onClick:function(e){return d(!0)}},r.a.createElement("svg",{className:"icon icon-down"},r.a.createElement("use",{xlinkHref:"svg/sprite.svg#arrow-down"}))),u&&r.a.createElement(se,{handleClick:function(e){y(e),d(!1)},setShow:d}))),p&&r.a.createElement("div",{className:"body3 date-error-wrap"},p.split("\n").map((function(e,t){return r.a.createElement("div",{key:t,className:"date-error"},e)}))))})),ye=Object(d.a)((function(e){return r.a.createElement("div",{className:"participant-filter"},e.values.map((function(e){return r.a.createElement("button",{key:e.value,className:e.selected?"participant-item active":"participant-item",tabIndex:0,onClick:e.selectOne},r.a.createElement("object",{type:"image/svg+xml",data:"".concat(s).concat(e.icon),"aria-label":e.preview}),r.a.createElement("p",{className:"subtitle3"},e.preview))})))})),he=Object(d.a)((function(e){var t=e.values;return r.a.createElement("div",null,t.map((function(e){return r.a.createElement("label",{key:e.value,className:"severity-item",tabIndex:0},r.a.createElement("input",{type:"checkbox",checked:e.selected,disabled:e.disabled,onChange:e.changeSelection}),r.a.createElement("span",{className:"checkmark"},r.a.createElement("svg",{className:"icon icon-check"},r.a.createElement("use",{xlinkHref:"svg/sprite.svg#check"}))),r.a.createElement("div",{className:"severity-color",style:{background:e.disabled?H:e.color}}),r.a.createElement("p",{className:"body1",style:{color:e.disabled?H:z}},e.preview))})))})),Ee=Object(d.a)((function(e){e.values;return r.a.createElement("div",{className:"category-item__draw",tabIndex:0},r.a.createElement("svg",{className:"icon icon-edit"},r.a.createElement("use",{xlinkHref:"svg/sprite.svg#edit"})),r.a.createElement("button",{className:"btn-rect"},"\u0412\u044b\u0434\u0435\u043b\u0438\u0442\u044c"))})),we=function(e){var t=e.filter;switch(t.name){case"date":return r.a.createElement(be,{filter:t});case"participant_categories":return r.a.createElement(ye,t);case"severity":return r.a.createElement(he,t);case"region":return r.a.createElement(Ee,t);default:return null}},Ne=Object(d.a)((function(e){var t=e.filter;return t.values.some((function(e){return e.selected}))?r.a.createElement("div",{className:"category-tag active"},r.a.createElement("button",{className:"btn-rect",onClick:function(e){return t.navigate()}},r.a.createElement("span",null,t.label)),r.a.createElement("button",{className:"btn-decline",onClick:function(e){return t.reset()}},r.a.createElement("svg",{className:"icon icon-decline"},r.a.createElement("use",{xlinkHref:"svg/sprite.svg#decline"})))):r.a.createElement("div",{className:"category-tag"},r.a.createElement("button",{className:"btn-rect",onClick:function(e){return t.navigate()}},r.a.createElement("span",null,t.label)))})),Se=Object(d.a)((function(){var e=Q().filterStore,t=e.filters,a=t.filter((function(e){return"category"!==e.name})),n=t.filter((function(e){return"category"===e.name}));return r.a.createElement("div",{className:"filter-panel"},r.a.createElement("div",{className:"filter-panel-normal"},a.map((function(e){return r.a.createElement("div",{key:e.name,className:"filter-item"},r.a.createElement("p",{className:"subtitle2"},e.label),r.a.createElement(we,{filter:e}))})),r.a.createElement("div",{className:"filter-item"},r.a.createElement("p",{className:"subtitle2"},"\u0424\u0438\u043b\u044c\u0442\u0440\u044b"),r.a.createElement("div",{className:"category-filter"},n.map((function(e){return r.a.createElement(Ne,{key:e.key,filter:e})}))))),r.a.createElement("button",{className:"btn-hideFilter",onClick:function(t){return e.setVisible(!1)}},r.a.createElement("svg",{className:"icon icon-arrow-up"},r.a.createElement("use",{xlinkHref:"svg/sprite.svg#arrow-up"})),r.a.createElement("span",null,"\u0421\u043a\u0440\u044b\u0442\u044c")))})),je=Object(d.a)((function(){var e=Q().filterStore,t=e.filters,a=t.find((function(e){return"date"===e.name})),n=(t.filter((function(e){var t;return null===(t=e.values)||void 0===t?void 0:t.some((function(e){return e.selected!==e.default}))}))||[]).map((function(e){return e.label})).join(", ");return r.a.createElement("div",{className:"filter-panel"},r.a.createElement("div",{className:"filter-panel-hidden"},r.a.createElement("div",{className:"filter-item"},r.a.createElement("p",{className:"subtitle2"},a.label),r.a.createElement(be,{filter:a})),n&&r.a.createElement("div",{className:"filter-item"},r.a.createElement("p",{className:"subtitle2"},"\u0410\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u0444\u0438\u043b\u044c\u0442\u0440\u044b"),r.a.createElement("div",{className:"category-filter"},n))),r.a.createElement("button",{className:"btn-hideFilter",onClick:function(t){return e.setVisible(!0)}},r.a.createElement("svg",{className:"icon icon-arrow-up"},r.a.createElement("use",{xlinkHref:"svg/sprite.svg#arrow-down"})),r.a.createElement("span",null,"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c")))})),ke=Object(d.a)((function(){var e=Q().filterStore,t=e.filters.find((function(t){return t.key===e.currentKey}));return r.a.createElement("div",{className:"filter-header"},r.a.createElement("button",{className:"btn-back",onClick:function(t){e.setCurrentKey(null),e.setSearch("")}},r.a.createElement("svg",{className:"icon icon-arrow-back"},r.a.createElement("use",{xlinkHref:"svg/sprite.svg#arrow-back"})),r.a.createElement("span",null,t.label)),r.a.createElement("div",{className:"inputWrap"},r.a.createElement("input",{type:"text",className:"input",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043d\u0430\u0440\u0443\u0448\u0435\u043d\u0438\u044f",value:e.search,onChange:function(t){return e.setSearch(t.target.value)}}),r.a.createElement("button",{className:"btn-search"},r.a.createElement("svg",{className:"icon icon-search"},r.a.createElement("use",{xlinkHref:"svg/sprite.svg#search"})))))})),Ce=Object(d.a)((function(e){var t=e.value;return r.a.createElement("label",{className:"category-value severity-item",tabIndex:0},r.a.createElement("input",{type:"checkbox",checked:t.selected,onChange:function(e){return t.toggle()}}),r.a.createElement("span",{className:"checkmark"},r.a.createElement("svg",{className:"icon icon-check"},r.a.createElement("use",{xlinkHref:"svg/sprite.svg#check"}))),r.a.createElement("span",{className:"value-preview body1"},t.preview))})),Oe=Object(d.a)((function(){var e=Q().filterStore,t=e.filters.find((function(t){return t.key===e.currentKey})),a=e.search.toLowerCase();return r.a.createElement("div",{className:"filter-panel"},r.a.createElement("div",{className:"filter-panel-category"},r.a.createElement(ke,null),r.a.createElement("div",{className:"panel-content"},t.values.filter((function(e){return e.preview.toLowerCase().includes(a)})).map((function(e){return r.a.createElement(Ce,{key:-1===e.value?e.preview:e.value,value:e})})))))})),Fe=Object(d.a)((function(){var e=Q().filterStore;return 0===e.filters.length?null:e.visible?e.currentKey?r.a.createElement(Oe,null):r.a.createElement(Se,null):r.a.createElement(je,null)})),_e=Object(d.a)((function(){var e=Q().areaStore,t=e.area,a=e.statistics;return t?r.a.createElement("div",{className:"info-panel-wrap"},r.a.createElement("div",{className:"info-panel"},r.a.createElement("h3",{className:"h3"},t.name||"\xa0"),r.a.createElement("p",{className:"subtitle2",style:{color:H}},"\u0414\u0422\u041f"),r.a.createElement("p",{className:"subtitle2",style:{color:H}},"\u041f\u043e\u0441\u0442\u0440\u0430\u0434\u0430\u043b\u0438"),r.a.createElement("p",{className:"subtitle2",style:{color:H}},"\u041f\u043e\u0433\u0438\u0431\u043b\u0438"),r.a.createElement("p",{className:"body2",style:{color:H}},t.parentName),r.a.createElement("h3",{className:"h3",style:{color:z}},a?a.count:"-"),r.a.createElement("h3",{className:"h3",style:{color:B}},a?a.injured:"-"),r.a.createElement("h3",{className:"h3",style:{color:M}},a?a.dead:"-"))):null})),xe=function(){return r.a.createElement(G.Provider,{value:q},r.a.createElement(X,null),r.a.createElement(ee,null),r.a.createElement("div",{className:"ui-layer"},r.a.createElement(Fe,null),r.a.createElement(_e,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a({dsn:u}),o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(xe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[46,1,2]]]);
//# sourceMappingURL=main.7391cf9b.chunk.js.map